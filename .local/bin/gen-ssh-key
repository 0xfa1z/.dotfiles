#!/bin/bash

# Check if a parameter is given
if [ -z "$1" ]; then
    echo "Error: No key name provided."
    echo "Usage: $0 <key_name>"
    echo "Key names to use for git: git_me, git_im, git_uni"
    exit 1
fi

key_name=$1

# Directory to hold SSH keys for the sfaiz user
SSH_DIR="$HOME/.ssh"

# SSH key files
PRIVATE_KEY="$SSH_DIR/$key_name"
PUBLIC_KEY="$SSH_DIR/$key_name.pub"

# Check if SSH directory exists
if [ ! -d "$SSH_DIR" ]; then
    mkdir -p "$SSH_DIR"
    chmod 700 "$SSH_DIR"
fi

# Generate SSH keys if they don't exist
if [ ! -f "$PRIVATE_KEY" ] || [ ! -f "$PUBLIC_KEY" ]; then
    ssh-keygen -t rsa -b 4096 -f "$PRIVATE_KEY" -N ""
    echo "New SSH key pair generated."
else
    echo "Existing SSH key pair found."
fi

# Output the public key
echo "Copy the following SSH public key and add it to your GitHub account:"
cat "$PUBLIC_KEY"
