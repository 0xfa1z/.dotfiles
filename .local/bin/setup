#!/bin/bash

setupDotfilesRepo() {
  # Define a local function 'dotfiles' that uses git with a specific git directory and work tree
  dotfiles() {
    git --git-dir=$HOME/.dotfiles --work-tree=$HOME "$@"
  }

  # Configure the dotfiles repo to not show untracked files in git status
  dotfiles config --local status.showUntrackedFiles no

  # Check if a README.md file exists in the current directory
  if [ -f "README.md" ]; then
    # Remove README.md from the git index (unstage it)
    dotfiles reset README.md

    # Tell git to ignore changes to README.md
    dotfiles update-index --assume-unchanged README.md

    # Move README.md from home directory to the .dotfiles directory
    mv $HOME/README.md $HOME/.dotfiles/README.md
  fi
}

setupZsh() {
  sudo apt -y install zsh

  # Change the default shell to Zsh for the current user
  # $(which zsh) dynamically finds the path to the Zsh executable
  sudo chsh -s $(which zsh) $USER
}

setupDotfilesRepo
sudo apt update
sudo apt -y upgrade
setupZsh
